@import controllers.project.{routes => projectRoutes}
@import controllers.sugar.Requests.OreRequest
@import ore.OreConfig
@import ore.permission._

@(user: Boolean = true)(implicit messages: Messages, request: OreRequest[_], config: OreConfig)

<div class="navbar navbar-expand-lg navbar-dark fixed-top" id="topbar">
    <div class="container">
        <div id="sp-logo-container">
            <a class="logo" href="@routes.Application.showHome(None, None, None, None, None, None)">
                <img src="https://www.spongepowered.org/assets/img/icons/spongie-mark.svg" alt="" style="height: 40px">
                <span>Sponge</span>
                <i class="fas fa-chevron-down fa-fw"></i>
            </a>
            <div id="sp-logo-menu">
                <ul id="sp-logo-dropdown">
                    <li>
                        <a href="https://www.spongepowered.org">
                            <i class="fas fa-home fa-fw"></i>
                            Homepage
                        </a>
                    </li>
                    <li>
                        <a href="https://forums.spongepowered.org">
                            <i class="fas fa-comments fa-fw"></i>
                            Forums
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/SpongePowered">
                            <i class="fas fa-code fa-fw"></i>
                            Code
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.spongepowered.org">
                            <i class="fas fa-book fa-fw"></i>
                            Docs
                        </a>
                    </li>
                    <li>
                        <a href="https://jd.spongepowered.org">
                            <i class="fas fa-graduation-cap fa-fw"></i>
                            Javadocs
                        </a>
                    </li>
                    <li>
                        <a href="https://forums.spongepowered.org/c/plugins/plugin-releases">
                            <i class="fas fa-comments fa-plug fa-fw"></i>
                            Plugins
                        </a>
                    </li>
                    <li class="active">
                        <a href="https://ore.spongepowered.org/">
                            <img src="https://spongepowered.org/assets/img/icons/ore.svg" alt="" class="ore-nav fa-fw">
                            Ore <sup>Beta</sup>
                        </a>
                    </li>
                    <li>
                        <a href="https://ore.spongepowered.org">
                            <i class="fas fa-download fa-fw"></i>
                            Downloads
                        </a>
                    </li>
                    <li>
                        <a href="https://www.spongepowered.org/chat">
                            <i class="fas fa-comments fa-fw"></i>
                            Chat
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        @if(user) {

            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#rightTopNav" aria-controls="rightTopNav" aria-expanded="false" aria-label="Toggle navigation">
                <i class="fas fa-bars fa-lg"></i>
            </button>

            <div class="collapse navbar-collapse" id="rightTopNav">
                <ul class="navbar-nav ml-auto">
                @request.headerData.currentUser.map { cu =>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" id="newDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-plus fa-fw"></i>
                        New
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="newDropdown">
                        <a class="dropdown-item" href="@projectRoutes.ProjectCreation.showStep1()">
                            <i class="fas fa-book fa-fw"></i>
                            @messages("project.create")
                        </a>
                        <a class="dropdown-item" href="@routes.Organizations.showCreator()">
                            <i class="fas fa-users fa-fw"></i>
                            @messages("org.create")
                        </a>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="@routes.Users.showAuthors(None, None)">
                        <i class="fas fa-users fa-fw"></i>
                        Authors
                    </a>
                </li>
                @if(request.headerData.globalPerm(ReviewProjects)) {
                    <li class="nav-item">
                        <a class="nav-link" href="@routes.Users.showStaff(None, None)">
                            <i class="fas fa-user-tie fa-fw"></i>
                            Staff
                        </a>
                    </li>
                }
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <img height="32" width="32" class="user-avatar" src="@cu.avatarUrl" />
                        <span class="d-lg-none">@cu.name</span>
                        @if(request.headerData.hasNotice) {
                            <span class="unread-circle"></span>
                        }
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                        <a class="dropdown-item" href="@routes.Users.showProjects(cu.name, None)">
                            <i class="fas fa-user fa-fw"></i>
                            @cu.name
                        </a>
                        <a class="dropdown-item" href="@routes.Users.showNotifications(None, None)">
                            <i class="fas fa-bell fa-fw @if(request.headerData.hasUnreadNotifications) { unread }"></i>
                            @messages("notification.plural")
                        </a>

                        @if(request.headerData.globalPerm(ReviewFlags)) {
                            <a class="dropdown-item" href="@routes.Application.showFlags()">
                                <i class="fas fa-flag fa-fw @if(request.headerData.unresolvedFlags) { unread }"></i>
                                @messages("project.flag.plural")
                            </a>
                        }
                        @if(request.headerData.globalPerm(ReviewVisibility)) {
                            <a class="dropdown-item" href="@routes.Application.showProjectVisibility()">
                                <i class="fas fa-thumbs-up fa-fw @if(request.headerData.hasProjectApprovals) { unread }"></i>
                                Project approvals
                            </a>
                        }
                        @if(request.headerData.globalPerm(ReviewProjects)) {
                            <a class="dropdown-item" href="@routes.Reviews.showVersionQueuePending(None)">
                                <i class="far fa-thumbs-up fa-fw @if(request.headerData.hasReviewQueue) { unread }"></i>
                                @messages("user.queue")
                            </a>
                        }
                        @if(request.headerData.globalPerm(ViewStats)) {
                            <a class="dropdown-item" href="@routes.Application.showStats()">
                                <i class="fas fa-chart-line fa-fw"></i>
                                @messages("user.stats")
                            </a>
                        }
                        @if(request.headerData.globalPerm(ViewHealth)) {
                            <a class="dropdown-item" href="@routes.Application.showHealth()">
                                <i class="fas fa-heartbeat fa-fw"></i>
                                @messages("admin.health.title")
                            </a>
                        }

                        @if(request.headerData.globalPerm(ViewLogs)) {
                            <a class="dropdown-item" href="@routes.Application.showLog(None, None, None, None, None, None, None)">
                                <i class="fas fa-list fa-fw"></i>
                                @messages("admin.log.title")
                            </a>
                        }
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="@routes.Users.logOut()">
                            <i class="fas fa-sign-out-alt fa-fw"></i>
                            @messages("general.signout")
                        </a>
                    </div>
                </li>
                }.getOrElse {
                    <li class="nav-item">
                        <a class="nav-link" href="@routes.Users.signUp()">
                            <i class="fas fa-user-plus fa-fw"></i>
                            @messages("general.signup")
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="@routes.Users.logIn(None, None, Some(request.path))">
                            <i class="fas fa-sign-in-alt fa-fw"></i>
                            @messages("general.login")
                        </a>
                    </li>
                }
                </ul>
            </div>
        }
    </div>
</div>
